<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>crops.core.sequence &#8212; CROPS v0.3.1</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css" />
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script src="../../../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default ">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../../index.html">
          CROPS</a>
        <span class="navbar-text navbar-version pull-left"><b>0.3.1</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../../index.html">Home</a></li>
                <li><a href="../../../install.html">Installation</a></li>
                <li><a href="../../../examples.html">Examples</a></li>
                <li><a href="../../../contents.html">Documentation</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Home <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"></ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for crops.core.sequence</h1><div class="highlight"><pre>
<span></span><span class="c1"># -*- coding: utf-8 -*-</span>

<span class="kn">from</span> <span class="nn">crops.about</span> <span class="kn">import</span> <span class="n">__prog__</span><span class="p">,</span> <span class="n">__description__</span><span class="p">,</span> <span class="n">__author__</span><span class="p">,</span> <span class="n">__date__</span><span class="p">,</span> <span class="n">__version__</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">copy</span>
<span class="kn">from</span> <span class="nn">warnings</span> <span class="kn">import</span> <span class="n">warn</span>

<div class="viewcode-block" id="retrieve_id"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.retrieve_id">[docs]</a><span class="k">def</span> <span class="nf">retrieve_id</span><span class="p">(</span><span class="n">seqheader</span><span class="p">,</span><span class="n">extrainfo</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Extracts sequence IDs from a standard .fasta header.</span>

<span class="sd">    :param seqheader: Standard .fasta header, starting with &quot;&gt;&quot;.</span>
<span class="sd">    :type seqheader: str</span>
<span class="sd">    :param extrainfo: If True extra information string is returned, instead of sequence IDs, defaults to False.</span>
<span class="sd">    :type extrainfo: bool, optional</span>
<span class="sd">    :raises ValueError: If seqheader is not a string.</span>
<span class="sd">    :return: A list with the two sequence identifiers (e.g. [pdb ID, chain ID]) or a single string if extrainfo==True.</span>
<span class="sd">    :rtype: list, str</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seqheader</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Argument is not a str&#39;</span><span class="p">)</span>
    <span class="n">namechar</span><span class="o">=</span><span class="kc">False</span>
    <span class="n">idchar</span><span class="o">=</span><span class="kc">False</span>
    <span class="n">nameseq</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;&#39;</span><span class="p">,[]]</span>
    <span class="n">newchid</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
    <span class="k">if</span> <span class="n">seqheader</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;&gt;sp|&#39;</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">seqheader</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;|&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">extrainfo</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">i</span><span class="p">:]</span>
                <span class="k">break</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">nameseq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+=</span><span class="n">seqheader</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">nameseq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="p">[</span><span class="n">nameseq</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">nameseq</span>

    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">seqheader</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;&gt;&quot;</span><span class="p">:</span>
            <span class="n">idchar</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">elif</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;:&quot;</span> <span class="ow">or</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;_&quot;</span><span class="p">:</span>
            <span class="n">idchar</span><span class="o">=</span><span class="kc">False</span>
            <span class="n">namechar</span><span class="o">=</span><span class="kc">True</span>
        <span class="k">elif</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;|&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;Chain&#39;</span> <span class="ow">or</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">6</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;chain&#39;</span><span class="p">:</span>
                <span class="n">k</span><span class="o">=</span><span class="mi">0</span> <span class="k">if</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">7</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39; &#39;</span> <span class="k">else</span> <span class="mi">1</span>
                <span class="n">newchid</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
                <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="o">+</span><span class="mi">7</span><span class="o">+</span><span class="n">k</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">seqheader</span><span class="p">)):</span>
                    <span class="k">if</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;,&#39;</span><span class="p">:</span>
                        <span class="n">nameseq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newchid</span><span class="p">)</span>
                        <span class="n">newchid</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
                    <span class="k">elif</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;|&quot;</span> <span class="ow">or</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot;:&quot;</span> <span class="ow">or</span> <span class="n">jj</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">seqheader</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">extrainfo</span><span class="p">:</span>
                            <span class="k">if</span> <span class="n">jj</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">seqheader</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                                <span class="k">return</span> <span class="s1">&#39;&#39;</span>
                            <span class="k">else</span><span class="p">:</span>
                                <span class="k">return</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">jj</span><span class="p">:]</span>
                        <span class="k">if</span> <span class="n">jj</span><span class="o">==</span><span class="nb">len</span><span class="p">(</span><span class="n">seqheader</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                            <span class="n">newchid</span><span class="o">+=</span><span class="n">seqheader</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span>
                        <span class="n">nameseq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newchid</span><span class="p">)</span>
                        <span class="n">newchid</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
                        <span class="k">return</span> <span class="n">nameseq</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">newchid</span><span class="o">+=</span><span class="n">seqheader</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">extrainfo</span><span class="p">:</span>
                    <span class="k">return</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="p">:]</span>
                <span class="n">nameseq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newchid</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">nameseq</span>
        <span class="k">elif</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">==</span><span class="s2">&quot; &quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">extrainfo</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="p">:]</span>
            <span class="k">if</span> <span class="n">namechar</span><span class="p">:</span>
                <span class="n">nameseq</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">newchid</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">nameseq</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">namechar</span><span class="p">:</span>
                <span class="n">newchid</span> <span class="o">+=</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
            <span class="k">elif</span> <span class="n">idchar</span><span class="p">:</span>
                <span class="n">nameseq</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">seqheader</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span></div>

<div class="viewcode-block" id="monomer_sequence"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence">[docs]</a><span class="k">class</span> <span class="nc">monomer_sequence</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A sequence object representing a single chain sequence.</span>
<span class="sd">    The monomer sequence class represents a data structure to hold all</span>
<span class="sd">    sequences and other useful information characterising the monomer.</span>
<span class="sd">    It contains functions to store, manipulate and organise sequences.</span>

<span class="sd">    :param chid: Chain ID.</span>
<span class="sd">    :type chid: str</span>
<span class="sd">    :param seq: Sequence string.</span>
<span class="sd">    :type seq: str, optional</span>
<span class="sd">    :param header: Standard .fasta header, starting with &quot;&gt;&quot;.</span>
<span class="sd">    :type seqheader: str, optional</span>
<span class="sd">    :ivar info: Useful information of the :class:`~crops.core.sequence.monomer_sequence`.</span>
<span class="sd">    :type info: dict</span>
<span class="sd">    :ivar seqs: The set of sequences, including default &quot;mainseq&quot;, in :class:`~crops.core.sequence.monomer_sequence`.</span>
<span class="sd">    :type seqs: dict</span>

<span class="sd">    :example:</span>

<span class="sd">    &gt;&gt;&gt; from crops.core import monomer_sequence</span>
<span class="sd">    &gt;&gt;&gt; my_monomer = monomer_sequence(&#39;example_id&#39;)</span>
<span class="sd">    &gt;&gt;&gt; my_monomer.mainseq(&#39;GATTACA&#39;)</span>
<span class="sd">    &gt;&gt;&gt; my_monomer.mainseq()</span>
<span class="sd">    &#39;GATTACA&#39;</span>
<span class="sd">    &gt;&gt;&gt; my_monomer.addseq(&#39;gapseq&#39;,&#39;GAT--C-&#39;)</span>
<span class="sd">    &gt;&gt;&gt; my_monomer.addseq(&#39;cobra&#39;,&#39;TACATACA&#39;)</span>
<span class="sd">    &gt;&gt;&gt; my_monomer.length()</span>
<span class="sd">    7</span>
<span class="sd">    &gt;&gt;&gt; my_monomer.ngaps(&#39;gapseq&#39;)</span>
<span class="sd">    3</span>
<span class="sd">    &gt;&gt;&gt; print(my_monomer)</span>
<span class="sd">    Single chain sequence object: (id=&#39;example_id&#39;, seq=&#39;GATTACA&#39;, length=7)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;Single chain sequence&#39;</span>
    <span class="vm">__slots__</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;info&#39;</span><span class="p">,</span><span class="s1">&#39;seqs&#39;</span><span class="p">]</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chid</span><span class="p">,</span><span class="n">seq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="o">=</span><span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="o">=</span><span class="p">{}</span>
        <span class="k">if</span> <span class="n">chid</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chid</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;chain_id&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">chid</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Chain ID &#39;chid&#39; should be a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">seq</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">seq</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Chain sequence &#39;seq&#39; should be a string.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">header</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">header</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">header</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;oligomer_id&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">retrieve_id</span><span class="p">(</span><span class="n">header</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Sequence chain header &#39;header&#39; should be a string.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;oligomer_id&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="s1">&#39;mainseq&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;mainseq sequence not found.&#39;</span><span class="p">)</span>
        <span class="n">showseq</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">])</span><span class="o">&lt;=</span><span class="mi">20</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">][:</span><span class="mi">10</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;[...]&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">][</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">])</span><span class="o">-</span><span class="mi">10</span><span class="p">:]</span>
        <span class="k">if</span> <span class="s1">&#39;oligomer_id&#39;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">:</span>
            <span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="o">+</span><span class="s2">&quot; object: ( id=&quot;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;oligomer_id&#39;</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;chain_id&#39;</span><span class="p">]</span> <span class="o">+</span><span class="s2">&quot;, seq=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">showseq</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;, length=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s2">&quot; )&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="o">+</span><span class="s2">&quot; object: ( id=&quot;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;chain_id&#39;</span><span class="p">]</span> <span class="o">+</span><span class="s2">&quot;, seq=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">showseq</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot;, length=&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]))</span><span class="o">+</span><span class="s2">&quot; )&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<div class="viewcode-block" id="monomer_sequence.copy"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="monomer_sequence.deepcopy"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.deepcopy">[docs]</a>    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="monomer_sequence.addseq"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.addseq">[docs]</a>    <span class="k">def</span> <span class="nf">addseq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">newid</span><span class="p">,</span><span class="n">newseq</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add sequence to :class:`~crops.core.sequence.monomer_sequence`.</span>

<span class="sd">        :param newid: New sequence&#39;s identifier.</span>
<span class="sd">        :type newid: str</span>
<span class="sd">        :param newseq: New sequence.</span>
<span class="sd">        :type newseq: str</span>
<span class="sd">        :raises TypeError: If newid is not a string.</span>
<span class="sd">        :raises KeyError: If sequence is not a string.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">newid</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;New sequence ID &#39;newid&#39; should be a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">newseq</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;New sequence string &#39;newseq&#39; should be a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">newid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Key name &#39;newid&#39; already exists.&quot;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="n">newid</span><span class="p">]</span><span class="o">=</span><span class="n">newseq</span></div>

<div class="viewcode-block" id="monomer_sequence.delseq"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.delseq">[docs]</a>    <span class="k">def</span> <span class="nf">delseq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">delid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">wipeall</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Deletes sequence(s) from :class:`~crops.core.sequence.monomer_sequence`.</span>

<span class="sd">        :param delid: ID of sequence to be deleted, defaults to None.</span>
<span class="sd">        :type delid: str, optional</span>
<span class="sd">        :param wipeall: If True, all the sequences are deleted, defaults to False.</span>
<span class="sd">        :type wipeall: bool, optional</span>
<span class="sd">        :raises TypeError: If delid is not a string.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">wipeall</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="o">=</span><span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">delid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">delid</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Sequence ID &#39;delid&#39; should be a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">wipeall</span><span class="p">,</span><span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Boolean switch &#39;wipeall&#39; is neither True nor False.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">delid</span><span class="o">==</span><span class="s1">&#39;mainseq&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]</span><span class="o">=</span><span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">delid</span><span class="p">)</span></div>

<div class="viewcode-block" id="monomer_sequence.mainseq"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.mainseq">[docs]</a>    <span class="k">def</span> <span class="nf">mainseq</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">add</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns or modifies the main sequence.</span>

<span class="sd">        :param add: If included, main sequence is changed to &#39;add&#39; sequence instead of returned, defaults to None</span>
<span class="sd">        :type add: str, optional</span>
<span class="sd">        :raises TypeError: If &#39;add&#39; is not a string</span>
<span class="sd">        :return: If &#39;add&#39; is None, the main sequence is returned.</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">add</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">add</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;If included, sequence &#39;add&#39; should be a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">add</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]</span><span class="o">=</span><span class="n">add</span></div>

<div class="viewcode-block" id="monomer_sequence.dump"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.dump">[docs]</a>    <span class="k">def</span> <span class="nf">dump</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes header and main sequence to a file. If file exists, output is appended.</span>

<span class="sd">        :param out: An output filepath (str) or an open file.</span>
<span class="sd">        :type out: str, file</span>
<span class="sd">        :raises TypeError: If out is neither a string nor an open file.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Argument &#39;out&#39; should be a string or a file.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">oligomer_id</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">header</span><span class="o">=</span><span class="s1">&#39;&gt;&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">oligomer_id</span><span class="p">()</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">header</span><span class="o">+=</span><span class="n">retrieve_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">(),</span><span class="n">extrainfo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">()</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">ids</span><span class="o">=</span><span class="n">retrieve_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">())</span>
                <span class="n">header</span><span class="o">=</span><span class="s1">&#39;&gt;&#39;</span><span class="o">+</span><span class="n">ids</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;_&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">()</span><span class="o">+</span><span class="n">retrieve_id</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">header</span><span class="p">(),</span><span class="n">extrainfo</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">header</span><span class="o">=</span><span class="s1">&#39;&gt;&#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">chain_id</span><span class="p">()</span><span class="o">+</span><span class="s1">&#39;:CROPS&#39;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">io</span><span class="o">.</span><span class="n">IOBase</span><span class="p">):</span>
            <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="n">lenseq</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">])</span>
            <span class="n">nlines</span><span class="o">=</span><span class="nb">int</span><span class="p">((</span><span class="n">lenseq</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">80</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines</span><span class="p">):</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">][</span><span class="n">n</span><span class="o">*</span><span class="mi">80</span><span class="p">:(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">80</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">outpath</span><span class="o">=</span><span class="n">out</span>
            <span class="n">op</span><span class="o">=</span><span class="s1">&#39;a&#39;</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">outpath</span><span class="p">)</span> <span class="k">else</span> <span class="s1">&#39;w&#39;</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">outpath</span><span class="p">,</span> <span class="n">op</span><span class="p">)</span> <span class="k">as</span> <span class="n">out</span><span class="p">:</span>
                <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">header</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
                <span class="n">lenseq</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">])</span>
                <span class="n">nlines</span><span class="o">=</span><span class="nb">int</span><span class="p">((</span><span class="n">lenseq</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">80</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span>
                <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nlines</span><span class="p">):</span>
                    <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">][</span><span class="n">n</span><span class="o">*</span><span class="mi">80</span><span class="p">:(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">80</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="monomer_sequence.length"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.length">[docs]</a>    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the length of the main sequence.</span>

<span class="sd">        :return n: Length of the main sequence.</span>
<span class="sd">        :rtype n: int</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="monomer_sequence.full_length"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.full_length">[docs]</a>    <span class="k">def</span> <span class="nf">full_length</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the length of the full sequence. If not found, the length of the main sequence is returned.&#39;</span>

<span class="sd">        :return n: Length of the full sequence.</span>
<span class="sd">        :rtype n: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;fullseq&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;fullseq&#39;</span><span class="p">]</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;mainseq&#39;</span><span class="p">]</span>

        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="s1">&#39;fullseq&#39;</span><span class="p">])</span></div>

<div class="viewcode-block" id="monomer_sequence.ngaps"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.ngaps">[docs]</a>    <span class="k">def</span> <span class="nf">ngaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">seqid</span><span class="o">=</span><span class="s1">&#39;gapseq&#39;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the number of gaps (&#39;-&#39;) in a sequence.</span>

<span class="sd">        :param seqid: The ID of the sequence containing the gaps, defaults to &#39;gapseq&#39;.</span>
<span class="sd">        :type seqid: str, optional</span>
<span class="sd">        :raises TypeError: If seqid is not a string.</span>
<span class="sd">        :return: Number of gaps in seqid.</span>
<span class="sd">        :rtype: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seqid</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Sequence ID &#39;seqid&#39; should be a string.&quot;</span><span class="p">)</span>
        <span class="n">n</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="n">seqid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="n">seqid</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">char</span><span class="o">==</span><span class="s1">&#39;-&#39;</span><span class="p">:</span>
                    <span class="n">n</span><span class="o">+=</span><span class="mi">1</span>
        <span class="k">return</span> <span class="n">n</span></div>

<div class="viewcode-block" id="monomer_sequence.ncrops"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.ncrops">[docs]</a>    <span class="k">def</span> <span class="nf">ncrops</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">seqid</span><span class="o">=</span><span class="s1">&#39;cropseq&#39;</span><span class="p">,</span> <span class="n">offterminals</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">offmidseq</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

        <span class="sd">&quot;&quot;&quot;Returns the number of cropped elements (&#39;+&#39;,&#39;*&#39;) in a sequence.</span>

<span class="sd">        :param seqid: The ID of the sequence containing the cropped elements, defaults to &#39;cropseq&#39;.</span>
<span class="sd">        :type seqid: str, optional</span>
<span class="sd">        :param offterminals: Count those removed from terminals only, defaults to False</span>
<span class="sd">        :type offterminals: bool, optional</span>
<span class="sd">        :param offmidseq: Count those removed NOT from terminals only, defaults to False</span>
<span class="sd">        :type offmidseq: bool, optional</span>
<span class="sd">        :raises TypeError: If seqid is not a string.</span>
<span class="sd">        :return: Number of cropped elements in seqid according to interval chosen.</span>
<span class="sd">        :rtype: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seqid</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Sequence ID &#39;seqid&#39; should be a string.&quot;</span><span class="p">)</span>

        <span class="n">n</span><span class="o">=</span><span class="mi">0</span>
        <span class="k">if</span> <span class="n">seqid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">n</span>

        <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="n">seqid</span><span class="p">]:</span>
            <span class="k">if</span> <span class="n">char</span><span class="o">==</span><span class="s1">&#39;+&#39;</span> <span class="ow">or</span> <span class="n">char</span><span class="o">==</span><span class="s1">&#39;*&#39;</span><span class="p">:</span>
                <span class="n">n</span><span class="o">+=</span><span class="mi">1</span>

        <span class="k">if</span> <span class="p">(</span><span class="n">offterminals</span><span class="o">==</span><span class="kc">False</span> <span class="ow">and</span> <span class="n">offmidseq</span><span class="o">==</span><span class="kc">False</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">offterminals</span><span class="o">==</span><span class="kc">True</span> <span class="ow">and</span> <span class="n">offmidseq</span><span class="o">==</span><span class="kc">True</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">n</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nterms</span><span class="o">=</span><span class="mi">0</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="n">seqid</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">char</span><span class="o">==</span><span class="s1">&#39;+&#39;</span> <span class="ow">or</span> <span class="n">char</span><span class="o">==</span><span class="s1">&#39;*&#39;</span><span class="p">:</span>
                    <span class="n">nterms</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>
            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">seqs</span><span class="p">[</span><span class="n">seqid</span><span class="p">]):</span>
                <span class="k">if</span> <span class="n">char</span><span class="o">==</span><span class="s1">&#39;+&#39;</span> <span class="ow">or</span> <span class="n">char</span><span class="o">==</span><span class="s1">&#39;*&#39;</span><span class="p">:</span>
                    <span class="n">nterms</span><span class="o">+=</span><span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">break</span>

        <span class="k">if</span> <span class="n">offterminals</span><span class="o">==</span><span class="kc">False</span> <span class="ow">and</span> <span class="n">offmidseq</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">n</span><span class="o">-</span><span class="n">nterms</span>
        <span class="k">elif</span> <span class="n">offterminals</span><span class="o">==</span><span class="kc">True</span> <span class="ow">and</span> <span class="n">offmidseq</span><span class="o">==</span><span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">nterms</span></div>

<div class="viewcode-block" id="monomer_sequence.header"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.header">[docs]</a>    <span class="k">def</span> <span class="nf">header</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the header identifying the sequence in a fasta file.</span>

<span class="sd">        :return: Fasta format header.</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;header&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;header&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="monomer_sequence.oligomer_id"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.oligomer_id">[docs]</a>    <span class="k">def</span> <span class="nf">oligomer_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the oligomer ID.</span>

<span class="sd">        :return: Oligomer ID.</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;oligomer_id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;oligomer_id&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;oligomer_id&#39;</span><span class="p">]</span></div>

<div class="viewcode-block" id="monomer_sequence.chain_id"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.monomer_sequence.chain_id">[docs]</a>    <span class="k">def</span> <span class="nf">chain_id</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the chain ID.</span>

<span class="sd">        :return: Chain ID.</span>
<span class="sd">        :rtype: str</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;chain_id&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;chain_id&#39;</span><span class="p">]</span><span class="o">=</span><span class="kc">None</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">info</span><span class="p">[</span><span class="s1">&#39;chain_id&#39;</span><span class="p">]</span></div></div>

<div class="viewcode-block" id="Sequence"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.Sequence">[docs]</a><span class="k">class</span> <span class="nc">Sequence</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;A sequence object grouping several chain sequence objects.</span>
<span class="sd">    The Sequence class represents a data structure to hold all</span>
<span class="sd">     :class:`~crops.core.sequence.monomer_sequence` and other useful information</span>
<span class="sd">    characterising an oligomer.</span>

<span class="sd">    :param seq_id: Sequence identifier (e.g. PDB id).</span>
<span class="sd">    :type seq_id: str</span>
<span class="sd">    :param imer: Container of several :class:`~crops.core.sequence.monomer_sequence` making up the oligomer.</span>
<span class="sd">    :type imer: dict, optional</span>
<span class="sd">    :param source: Information concerning the source of the :class:`~crops.core.sequence.Sequence` (e.g. Uniprot).</span>
<span class="sd">    :type source: str, optional</span>
<span class="sd">    :ivar seq_id: Sequence identifier (e.g. PDB id).</span>
<span class="sd">    :type seq_id: str</span>
<span class="sd">    :ivar imer: Container of several :class:`~crops.core.sequence.monomer_sequence` making up the oligomer.</span>
<span class="sd">    :type imer: dict</span>
<span class="sd">    :ivar source: Information concerning the source of the :class:`~crops.core.sequence.Sequence` (e.g. Uniprot).</span>
<span class="sd">    :type source: str</span>

<span class="sd">    :example:</span>

<span class="sd">    &gt;&gt;&gt; from crops.core import Sequence</span>
<span class="sd">    &gt;&gt;&gt; my_sequence = Sequence(seq_id=&#39;example_id&#39;, source=&#39;docs&#39;)</span>
<span class="sd">    &gt;&gt;&gt; my_sequence.add_monomer(&#39;header_example&#39;,&#39;GATTACA&#39;,nid=&#39;mychain&#39;)</span>
<span class="sd">    &gt;&gt;&gt; my_sequence.add_monomer(&#39;another_header&#39;,&#39;TACATACA&#39;)</span>
<span class="sd">    &gt;&gt;&gt; my_sequence.nchains()</span>
<span class="sd">    2</span>
<span class="sd">    &gt;&gt;&gt; my_sequence.length(&#39;mychain&#39;)</span>
<span class="sd">    7</span>
<span class="sd">    &gt;&gt;&gt; my_sequence.write(&#39;/path/to/output/dir/&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(my_sequence)</span>
<span class="sd">    docs Protein/polynucleotide sequence object: (id=&#39;example_id&#39;, # chains = 2)</span>
<span class="sd">    &gt;&gt;&gt; my_sequence.purge()</span>
<span class="sd">    &gt;&gt;&gt; my_sequence.nchains()</span>
<span class="sd">    0</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">kind</span><span class="o">=</span><span class="s1">&#39;Protein/polynucleotide sequence&#39;</span>
    <span class="vm">__slots__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;seq_id&#39;</span><span class="p">,</span> <span class="s1">&#39;imer&#39;</span><span class="p">,</span> <span class="s1">&#39;source&#39;</span><span class="p">]</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">imer</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">source</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">seq_id</span><span class="p">,</span><span class="nb">str</span><span class="p">)</span> <span class="ow">and</span> <span class="n">seq_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Sequence ID &#39;seq_id&#39; should be a string.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">imer</span><span class="p">,</span><span class="nb">dict</span><span class="p">)</span> <span class="ow">and</span> <span class="n">imer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Monomer container &#39;imer&#39; should be a dictionary.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">imer</span><span class="p">,</span><span class="nb">dict</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">imer</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">monomer_sequence</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Monomer container &#39;imer&#39; should only contain elements of monomer_sequence class.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq_id</span> <span class="o">=</span> <span class="n">seq_id</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imer</span> <span class="o">=</span> <span class="n">imer</span> <span class="k">if</span> <span class="n">imer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="o">=</span> <span class="n">source</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">source</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">+</span><span class="s2">&quot; &quot;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="o">+</span><span class="s2">&quot; object: (id=&quot;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_id</span><span class="o">+</span><span class="s2">&quot;, # chains = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;)&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">string</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="o">+</span><span class="s2">&quot; object: (id=&quot;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_id</span><span class="o">+</span><span class="s2">&quot;, # chains = &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;)&quot;</span>
        <span class="k">return</span> <span class="n">string</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">iter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>

<div class="viewcode-block" id="Sequence.copy"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.Sequence.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequence.deepcopy"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.Sequence.deepcopy">[docs]</a>    <span class="k">def</span> <span class="nf">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequence.purge"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.Sequence.purge">[docs]</a>    <span class="k">def</span> <span class="nf">purge</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Empties the :class:`~crops.core.sequence.Sequence` without deleting the object itself.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">seq_id</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">source</span><span class="o">=</span><span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span></div>

<div class="viewcode-block" id="Sequence.add_monomer"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.Sequence.add_monomer">[docs]</a>    <span class="k">def</span> <span class="nf">add_monomer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nheader</span><span class="p">,</span> <span class="n">nseq</span><span class="p">,</span>  <span class="n">nid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span><span class="n">forceentry</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span> <span class="c1"># INCLUDE DEL_MONOMER</span>
        <span class="sd">&quot;&quot;&quot;Adds a new :class:`~crops.core.sequence.monomer_sequence` to the :class:`~crops.core.sequence.Sequence`.</span>

<span class="sd">        :param nheader: Standard .fasta header, starting with &quot;&gt;&quot;.</span>
<span class="sd">        :type nheader: str</span>
<span class="sd">        :param nseq: New sequence.</span>
<span class="sd">        :type nseq: str</span>
<span class="sd">        :param nid: New chain&#39;s identifier, defaults to None</span>
<span class="sd">        :type nid: str, optional</span>
<span class="sd">        :param forceentry: Switch to force entry under a new ID if nid already in, defaults to False</span>
<span class="sd">        :type forceentry: bool, optional</span>
<span class="sd">        :raises KeyError: When ID already in dictionary of :class:`~crops.core.sequence.monomer_sequence` and forceentry=False.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">nid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">nid</span><span class="o">=</span><span class="n">retrieve_id</span><span class="p">(</span><span class="n">nheader</span><span class="p">)</span>
            <span class="n">nid</span><span class="o">=</span><span class="n">nid</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">nid</span><span class="o">=</span><span class="p">[</span><span class="n">nid</span><span class="p">]</span>

        <span class="k">for</span> <span class="n">iid</span> <span class="ow">in</span> <span class="n">nid</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">iid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">forceentry</span><span class="p">:</span>
                    <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;add_monomer WARNING: Chain named &#39;</span><span class="o">+</span><span class="n">iid</span><span class="o">+</span><span class="s1">&#39; already exists in Sequence &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_id</span><span class="o">+</span><span class="s1">&#39;. Entry forced in with new name.&#39;</span><span class="p">)</span>
                    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
                        <span class="n">iid</span> <span class="o">+=</span> <span class="s1">&#39;R&#39;</span>
                        <span class="k">if</span> <span class="n">iid</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">:</span>
                            <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s1">&#39;add_monomer ERROR: Chain named &#39;</span><span class="o">+</span><span class="n">iid</span><span class="o">+</span><span class="s1">&#39; already exists in Sequence &#39;</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_id</span><span class="o">+</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">[</span><span class="n">iid</span><span class="p">]</span><span class="o">=</span><span class="n">monomer_sequence</span><span class="p">(</span><span class="n">chid</span><span class="o">=</span><span class="n">iid</span><span class="p">,</span><span class="n">seq</span><span class="o">=</span><span class="n">nseq</span><span class="p">,</span><span class="n">header</span><span class="o">=</span><span class="n">nheader</span><span class="p">)</span></div>


<div class="viewcode-block" id="Sequence.del_monomer"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.Sequence.del_monomer">[docs]</a>    <span class="k">def</span> <span class="nf">del_monomer</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nid</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Removes the selected :class:`~crops.core.sequence.monomer_sequence` from the :class:`~crops.core.sequence.Sequence`</span>

<span class="sd">        :param nid: Doomed chain&#39;s identifier</span>
<span class="sd">        :type nid: str</span>
<span class="sd">        :raises TypeError: When nid is not a string.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">nid</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;nid should be a string.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">nid</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">nid</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">warn</span><span class="p">(</span><span class="s1">&#39;del_monomer WARNING: Chain named &#39;</span><span class="o">+</span> <span class="n">nid</span><span class="o">+</span><span class="s1">&#39; not found in Sequence.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequence.write"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.Sequence.write">[docs]</a>    <span class="k">def</span> <span class="nf">write</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">outdir</span><span class="p">,</span> <span class="n">infix</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">single</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Writes all :class:`~crops.core.sequence.monomer_sequence` to .fasta file.</span>

<span class="sd">        :param outdir: Output directory.</span>
<span class="sd">        :type outdir: str</span>
<span class="sd">        :param infix: Mark to distinguish from original input file, defaults to &quot;&quot;.</span>
<span class="sd">        :type infix: str, optional</span>
<span class="sd">        :param single: If not None, only :class:`~crops.core.sequence.monomer_sequence` with ID given by single is written, defaults to None.</span>
<span class="sd">        :type single: str, optional</span>
<span class="sd">        :raises FileNotFoundError: Output directory not found.</span>
<span class="sd">        :raises TypeError: Argument &#39;single&#39; should be a string.</span>
<span class="sd">        :raises KeyError: Specific single ID not found in :class:`~crops.core.sequence.Sequence`.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">outdir</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">FileNotFoundError</span><span class="p">(</span><span class="n">outdir</span> <span class="o">+</span> <span class="s1">&#39; directory not found.&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">single</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">outpath</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_id</span><span class="o">+</span><span class="n">infix</span><span class="o">+</span><span class="s2">&quot;.fasta&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">monomer</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">:</span>
                <span class="n">monomer</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">outpath</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">single</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">single</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">single</span><span class="p">)</span>
                <span class="k">except</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;single=&#39;</span><span class="o">+</span><span class="n">single</span><span class="o">+</span><span class="s1">&#39; should be a string.&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">single</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">single</span> <span class="o">+</span> <span class="s2">&quot; not found in Sequence &quot;</span><span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq_id</span><span class="p">)</span>
            <span class="n">outpath</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">outdir</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">seq_id</span><span class="o">+</span><span class="s2">&quot;_&quot;</span><span class="o">+</span><span class="n">single</span><span class="o">+</span><span class="n">infix</span><span class="o">+</span><span class="s2">&quot;.fasta&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">[</span><span class="n">single</span><span class="p">]</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">outpath</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequence.length"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.Sequence.length">[docs]</a>    <span class="k">def</span> <span class="nf">length</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">chain</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns the length of a certain sequence.</span>

<span class="sd">        :param chain: ID of :class:`~crops.core.sequence.monomer_sequence`.</span>
<span class="sd">        :type chain: str</span>
<span class="sd">        :raises TypeError: When &#39;chain&#39; is not a string.</span>
<span class="sd">        :raises KeyError: Specific chain not found in :class:`~crops.core.sequence.Sequence`.</span>
<span class="sd">        :return: Length of :class:`~crops.core.sequence.monomer_sequence`.</span>
<span class="sd">        :rtype: int</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">chain</span><span class="p">,</span><span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;chain input must be a string.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">chain</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">[</span><span class="n">chain</span><span class="p">]</span><span class="o">.</span><span class="n">length</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">chain</span><span class="o">+</span><span class="s1">&#39; monomer not found in sequence.&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sequence.nchains"><a class="viewcode-back" href="../../../api/generated/crops.core.sequence.html#crops.core.sequence.Sequence.nchains">[docs]</a>    <span class="k">def</span> <span class="nf">nchains</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Returns number of :class:`~crops.core.sequence.monomer_sequence` in :class:`~crops.core.sequence.Sequence`.</span>

<span class="sd">        :return: Number of :class:`~crops.core.sequence.monomer_sequence` in :class:`~crops.core.sequence.Sequence`.</span>
<span class="sd">        :rtype: int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">imer</span><span class="p">)</span></div></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright 2020-2020, University of Liverpool.<br/>
      Last updated on 16 Sep 2020.<br/>
    </p>
  </div>
</footer>
  </body>
</html>